#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# è·å–å½“å‰åˆ†æ”¯åç§°
current_branch=$(git symbolic-ref --short HEAD)
echo "$current_branch"

# å®šä¹‰åˆ†æ”¯å‘½åè§„åˆ™çš„æ­£åˆ™è¡¨è¾¾å¼
branch_regex="^((chore|docs|feat|fix|perf|refactor|revert|style|test|hotfix|release)\/[a-z0-9_-]+|develop|release)$"

# æ£€æŸ¥å½“å‰åˆ†æ”¯åç§°æ˜¯å¦ç¬¦åˆè§„èŒƒ
if ! echo "$current_branch" | grep -E "$branch_regex" > /dev/null; then
  echo "ğŸš¨: æ— æ•ˆçš„ Git åˆ†æ”¯å!"
  echo "åˆ†æ”¯åå¿…é¡»éµå¾ªè¯¥æ¨¡å¼: ^((chore|docs|feat|fix|perf|refactor|revert|style|test|hotfix|release)\/[a-z0-9_-]+|develop|release)$"
  exit 1
fi

echo "æ ¡éªŒ Git åˆ†æ”¯å âœ…"

FORCE_COLOR=1 npx lint-staged

echo "pre-commit lint-staged âœ…"
